---
sidebar_position: 8
---

# Integra√ß√µes

## O que √© integra√ß√£o entre sistemas?

A **integra√ß√£o entre sistemas** √© o processo de conectar diferentes sistemas ou aplica√ß√µes, de modo que eles possam
**compartilhar informa√ß√µes e trabalhar de maneira coordenada**. A integra√ß√£o permite que dados e processos fluam
entre os sistemas, eliminando silos de informa√ß√£o e melhorando a efici√™ncia operacional, e possui os seguintes objetivo:

* **Automatiza√ß√£o de processos:** reduzir tarefas manuais e repetitivas, permitindo que sistemas troquem informa√ß√µes automaticamente;
* **Centraliza√ß√£o de informa√ß√µes:** unificar dados provenientes de diferentes fontes, facilitando a an√°lise e a tomada de decis√£o;
* **Melhoria da produtividade:** evitar retrabalho e aumentar a velocidade dos processos operacionais;
* **Aperfei√ßoamento da experi√™ncia do usu√°rio:** fornecer uma vis√£o integrada e consistente de dados em diferentes plataformas.

## Como funciona a integra√ß√£o entre sistemas no Hashdata? {#how-it-works}
A integra√ß√£o entre sistemas permite transferir todas as coletas diretamente dos servidores do **HashData** para um
servidor local (*on-premises*), um servidor na nuvem ou at√© mesmo servidores de terceiros.

H√° duas op√ß√µes de integra√ß√£o, via **API REST** ou com **Hashdata Advanced Reports**.

*  **API REST**

Uma API REST (*Application Programming Interface Representational State Transfer*) √© uma interface de comunica√ß√£o
entre sistemas que segue os princ√≠pios do REST (*Representational State Transfer*), um estilo de arquitetura para
projetar servi√ßos de rede. A integra√ß√£o via API REST permite que outros sistemas acessem os dados armazenados no Hashdata. A comunica√ß√£o entre os
sistemas √© feita via requisi√ß√µes HTTPS, utilizando um ***token* de autentica√ß√£o** para garantir a seguran√ßa das informa√ß√µes.

*  **Hashdata Advanced Reports**

A integra√ß√£o com o [**Hashdata Advanced Reports**](/advanced-reports) permite a cria√ß√£o relat√≥rios e pain√©is avan√ßados atualizados em tempo real,
ou seja, os dados inseridos nos formul√°rios s√£o automaticamente exportados para os relat√≥rios e pain√©is. Tanto os
pain√©is quanto os relat√≥rios s√£o f√°ceis de criar e n√£o requerem conhecimento especializado. Ap√≥s a configura√ß√£o, as integra√ß√µes
e sincroniza√ß√µes s√£o realizadas automaticamente pelo Hashdata em tempo real.


## Habilitar integra√ß√µes {#enable-integrations}

Para habilitar as integra√ß√µes, selecione o √≠cone de Integra√ß√µes no menu principal (lateral esquerda).
Depois siga as instru√ß√µes da p√°gina e escolha quais integra√ß√µes deseja habilitar.


### Configura√ß√£o da integra√ß√£o dos Formul√°rios {#config}
Ap√≥s habilitar as integra√ß√µes, √© necess√°rio informar quais formul√°rios devem ser integrados ao Hashdata Advanced Reports
e quais devem ser exportados via API REST.

1. Selecione o formul√°rio para habilitar a integra√ß√£o desejada: Hashdata Advanced Reports, REST API ou ambas;
2. Ao clicar em <img style={{width: "1.5rem"}} src={require("./images/setup.webp").default} alt="Configura√ß√µes"
className="no-zoom image-between-texts"/> para configurar as integra√ß√µes;
3. Defina, para cada elemento que comp√µes o formul√°rio, o **nome da quest√£o**, que √© um nome curto que identifica o
elemento no sistema. O **nome da quest√£o** e √© utilizado tamb√©m nas f√≥rmulas matem√°ticas e na exporta√ß√£o de dados.
Utilize o bot√£o <img style={{width: "12rem"}} src={require("./images/autofill.webp").default} alt="Preencher automaticamente"
className="no-zoom image-between-texts"/>, para o sistema sugerir o **nome da quest√£o**. Fa√ßa ajustes, caso
necess√°rio;
4. Se a integra√ß√£o com o HashData Advanced Reports tiver habilitada, ser√° mostrado  o campo **Nome do √≠ndice no Hashdata
Advanced Reports**. Este campo √© composto por um valor n√∫mero, que n√£o deve ser alterado, seguido por uma descri√ß√£o que
deve conter apenas letras, n√∫meros, sublinhados e tra√ßos, por exemplo: `21261-formulario-dados-pessoais`;

:::warning Aten√ß√£o!
Somente os formul√°rios marcadas para exporta√ß√£o via API REST ficar√£o acess√≠veis via API REST. E, da mesma forma, somente
os formul√°rios marcados para integra√ß√£o com o Hashdata Advanced Reports ficar√£o vis√≠veis na ferramenta.
:::

:::warning Aten√ß√£o!
Os rascunhos de formul√°rios tamb√©m podem ser exportados / integrados, mas √© necess√°rio ter em mente que esses formul√°rios
podem ter sua estrutura alterada a qualquer momento.
:::


## Integra√ß√£o via API REST {#api-rest}

A comunica√ß√£o entre os sistemas √© feita via requisi√ß√µes HTTPS, utilizando um token de autentica√ß√£o para garantir a seguran√ßa das informa√ß√µes.
Um token de autentica√ß√£o √© uma sequ√™ncia alfanum√©rica √∫nica, utilizada para autenticar e autorizar um usu√°rio ou
aplica√ß√£o que est√° acessando uma API REST. Ele funciona como uma "chave digital" que comprova que quem est√° realizando
a requisi√ß√£o tem permiss√£o para faz√™-lo.

Ap√≥s habilitar a integra√ß√£o API REST √© necess√°rio selecionar os formul√°rios acess√≠veis por meio desta integra√ß√£o.

O acesso aos dados √© feito por meio dos *end-point*. As URI's de cada recurso s√£o apresentadas a seguir,
mas antes √© necess√°rio entender como funciona a autentica√ß√£o.

:::success Autentica√ß√£o

### Envio do Token de Autentica√ß√£o: URI vs. Cabe√ßalho {#auth}

Na API Hashdata, o **token de autentica√ß√£o** pode ser enviado de duas formas para validar e autorizar
o acesso a recursos protegidos:

1. **Envio pela URI (*Query Parameter*)**
2. **Envio pelo Cabe√ßalho HTTP (HD-API-TOKEN)** üëà Op√ß√£o RECOMENDADA

Cada m√©todo tem vantagens e desvantagens, especialmente quando se trata de **seguran√ßa da informa√ß√£o**.

##### 1. Envio do Token pela URI
Exemplo de requisi√ß√£o com o token na **query string** da URL:
```
GET /users/export?token=abc123
```
###### **Vantagens**
- ‚úÖ **Facilidade de implementa√ß√£o**: √© simples incluir o token como um par√¢metro na URL, sem necessidade de modificar cabe√ßalhos da requisi√ß√£o.
- ‚úÖ **Uso em links diretos**: pode ser √∫til quando o cliente precisa compartilhar um link autenticado para um recurso espec√≠fico.

###### **Desvantagens**
- ‚ùå **Exposi√ß√£o em logs e hist√≥ricos**: como a URL fica vis√≠vel no navegador, hist√≥rico do usu√°rio e logs do servidor, o token pode ser facilmente comprometido.
- ‚ùå **Facilidade de intercepta√ß√£o**: se a requisi√ß√£o n√£o estiver protegida por **HTTPS**, um atacante pode capturar o token ao monitorar o tr√°fego de rede.
- ‚ùå **Risco de cache**: algumas configura√ß√µes de proxy e servidores podem armazenar a URL com o token, permitindo acesso indevido posteriormente.

---

##### 2. Envio do Token pelo Cabe√ßalho HTTP (HD-API-TOKEN)
Exemplo de requisi√ß√£o enviando o token no **cabe√ßalho HTTP**:
```
GET /users/export
HD-API-TOKEN: abc123
```
###### **Vantagens**
- ‚úÖ **Maior seguran√ßa**: o token n√£o √© exposto na URL, reduzindo o risco de vazamento em logs, hist√≥ricos de navega√ß√£o ou caches.
- ‚úÖ **Melhor controle de acesso**: cabe√ßalhos HTTP s√£o mais f√°ceis de manipular para pol√≠ticas de seguran√ßa, como restri√ß√µes de CORS e prote√ß√£o contra ataques de **replay**.
- ‚úÖ **Compat√≠vel com autentica√ß√£o JWT e OAuth**: esse m√©todo √© amplamente utilizado para autentica√ß√£o baseada em tokens, como **JWT (JSON Web Token)** e **OAuth 2.0**.

###### **Desvantagens**
- ‚ùå **Maior complexidade na implementa√ß√£o**: requer que o cliente configure corretamente o cabe√ßalho da requisi√ß√£o, o que pode ser mais dif√≠cil em algumas aplica√ß√µes.
- ‚ùå **Incompatibilidade com alguns servi√ßos**: certos navegadores ou clientes HTTP podem ter restri√ß√µes para modificar cabe√ßalhos personalizados.

:::warning Aten√ß√£o
Todos exemplos abaixo assumem que o token de autentica√ß√£o ser√° enviado via HTTP Header: `HD-API-TOKEN`
:::

### FORMUL√ÅRIOS {#forms}
Para listar os formul√°rios habilitados para integra√ß√£o, utilize o seguinte *end-point*:

```text
GET https://api2.hashdata.app/v1/export/forms
```

Considerando que na conta de exemplo o √∫nico formul√°rio configurado para a integra√ß√£o √© o "Formul√°rio de Dados Pessoais", ao executar a
requisi√ß√£o para o *end-point* de formul√°rios, obt√©m-se uma resposta como ao do exemplo a seguir:

```json
[
  {
    "form_id":"66f172c1dbb522a3729ab9a1",
    "form_name":"Formul√°rio de Dados Pessoais",
    "form_status":"DRAFT"
  }
]
```

#### Atributos Exportados

√â poss√≠vel criar atributos personalizados ([Atributos exportados](/forms/general-form-settings#exported-atributes)) que podem ser usados para selecionar, filtrar ou agrupar os formul√°rios e as coletas.

Por exemplo: Imagine que em uma Organiza√ß√£o existam alguns formul√°rios de auditoria entre outras centenas de formul√°rios e que a empresa deseja identificar e exportar apenas os dados de tais
formul√°rios sem vincular diretamente ao ID dos formul√°rios. H√° v√°rias formas de fazer isso, sendo uma delas criar um "Atributo exportado" chamado "tipo-de-formulario" com o valor "auditoria" em todos os formul√°rios de auditorias.
Assim, ao exportar a lista de formul√°rios, pode-se escolher apenas os formul√°rios que tenham o valor "auditoria" na chave/campo "tipo-de-formulario", ex.:

```json
[
  {
    "form_id":"66f172c1dbb522a3729ab9a1",
    "form_name":"Formul√°rio de Dados Pessoais",
    "form_status":"DRAFT",
    "tipo-de-formulario": "auditoria"
  }
]
```

### RESPOSTAS {#responses}
Para obter as respostas de um determinado formul√°rio √© necess√°rio informar o `formId` (identificador do formul√°rio):

```text
GET https://api2.hashdata.app/v1/export/forms/{formId}/responses
```
<small>*Substitua \{formId} pelo identificador do formul√°rio, ex.: 66f172c1dbb522a3729ab9a1*</small>
<br/>
<br/>

O *end-point* possui tamb√©m os seguintes par√¢metros opcionais:

* `from`: *DateTime* - Data/hora inicial usada para filtrar as respostas;
* `to`: *DateTime* - Data/hora final usada para filtrar as respostas.
* `removeNewLineFromTexts`: *boolean* - remove quebras de linhas das respostas do tipo texto (√© recomendado configurar com 'true');
* `<nome-do-campo>`: *texto* ou *n√∫mero* - filtra pelo "nome-do-campo". Ver [Nome do campo em Atributos do Elemento](/forms/elements/what-is-elements#element-attributes) e [Filtrar por campos do formul√°rio](#filter-by-question-name)

Use os par√¢metros `from` e `to` para paginar a resposta ou para obter os dados progressivamente (conforme inseridos no sistema).

:::success Formatos aceitos
Os par√¢metros `from` e `to` aceitam qualquer formato de `Date` do Javascript, por exemplo, data no
formato string (ISO 8601): `2024-12-31T23:59:59.999Z` (hora UTC). Os milesegundos s√£o opcionais, ex.: `2024-12-31T23:59:59Z`

Por exemplo, a URI para acessar as respostas do "Formul√°rio de Dados Pessoais", a partir das 12:00:00 do dia 01/01/2025 no hor√°rio
oficial brasileiro seria:

```text
GET https://api2.hashdata.app/v1/export/forms/66f172c1dbb522a3729ab9a1/responses?from=2025-01-01T15:00:00Z
```

E, a URI para acessar as respostas enviadas entre o dia 01/01/2025 e 02/01/2025 no hor√°rio
oficial brasileiro seria:

```text
GET https://api2.hashdata.app/v1/export/forms/66f172c1dbb522a3729ab9a1/responses?from=2025-01-01T03:00:00Z&to=2025-01-02T03:00:00Z
```
:::

#### Exemplo de resposta da chamada HTTP (body)

```json
[
    {
        "col_id": "6705960061539e305ab18576",
        "form_id": "66f172c1dbb522a3729ab9a1",
        "user_id": "64282604d86b5ebe18373ab2",
        "collection_date": "2024-01-01T20:25:19.592Z",
        "collection_received_date": "2024-01-01T20:30:01.156Z",
        "auditor": "Jo√£o da Silva",
        "data": "2024-10-09T12:00:00",
        "fabrica": "ABC",
        "peso1": 22,
        "peso2": 23,
        "peso3": 21,
        "peso-medio-calculado": 22,
        "pontos-na-auditoria": 706,
        "resultado-final-auditoria": 95,
        "tipo-de-formulario": "auditoria",
        "nao-conformidades_files": ["6705960061539e734ea934ac", "6705960061539e734ea836ef"]
    },
    { ... },
    { ... },
]
```

#### Filtrar por campos do formul√°rio (quest√µes do formul√°rio) {#filter-by-question-name}

Podemos utilizar as quest√µes dos formul√°rios nos filtros, por exemplo: no caso da resposta/coleta (JSON) exibida acima,
podemos filtrar todas as coletas da f√°brica cujo identificador √© "ABC", ex.:

```text
GET https://api2.hashdata.app/v1/export/forms/66f172c1dbb522a3729ab9a1/responses?from=2025-01-01T15:00:00Z&fabrica=ABC
```

:::warning Importante!
√â altamente recomendado usar os par√¢metros `from` e `to`, ou pelo menos o par√¢metro `from`, para limitar o espa√ßo temporal onde as coletas ser√£o procuradas.
Assim voc√™ ter√° uma resposta r√°pida, com baixa lat√™ncia.
Se n√£o especificar nenhum dos par√¢metros citados o sistema efetuar√° uma busca em todas as coletas e isso pode demorar, resultando em uma alta lat√™ncia.
:::

### DOWNLOAD DE IMAGENS E OUTROS ARQUIVOS

V√°rios tipos de arquivos podem ser anexados √†s quest√µes dos formul√°rios, tais como fotos, planilhas, documentos, etc.
Para buscar qualquer arquivo anexado a uma resposta, utilize o *end-point*:

```text
GET https://api2.hashdata.app/v1/export/forms/{{formId}}/responses/{{responseId}}/files/{{fileId}}
```
Na URL acima, substitua os par√¢metros `{{formId}}`, `{{responseId}}` e `{{fileId}}` pelos dados obtidos na coleta.
No caso da coleta citada acima, usada como exemplo, os valores seriam:
- `formId`: 66f172c1dbb522a3729ab9a1 ‚û°Ô∏è `form_id`
- `responseId`: 6705960061539e305ab18576 ‚û°Ô∏è `col_id`
- `fileId`: 6705960061539e734ea934ac ‚û°Ô∏è `nao-conformidades_files`


### COLABORADORES (USU√ÅRIOS) {#users}
Para listar todos os colaboradores de uma determinada √°rea de trabalho, utiliza o seguinte *end-point*:

```text
GET https://api2.hashdata.app/v1/export/users
```

Por padr√£o, esse *end-point* retorna os dados no formato JSON.
Ao executar a requisi√ß√£o sem informar par√¢metros, obt√©m-se uma resposta como a do exemplo a seguir:

```json
[
  {
      "user_id":"66ae9f205c7ed7e95d183804",
      "user_nickname":"Pedro",
      "user_full_name":"Pedro Alc√¢ntara",
      "user_department":""
  },
  {
      "user_id":"6752ff2b2536410b2897de91",
      "user_nickname":"Jos√©",
      "user_full_name":"Jos√© da Silva",
      "user_department":""
  }
]
```

√â poss√≠vel receber os dados dos colaboradores no formato CSV (*Comma-Separated Values*). Para isso, basta informar mais dois
par√¢metros: `format` e `separator`. Por exemplo:

```text
GET https://api2.hashdata.app/v1/export/users?format=csv&separator=;
```
Obtendo-se o seguinte resultado:

```text
user_id;user_nickname;user_full_name;user_department
66ae9f205c7ed7e95d183804;Pedro;Pedro Alc√¢ntara;
6752ff2b2536410b2897de91;Jos√©;Jos√© da Silva;
```
