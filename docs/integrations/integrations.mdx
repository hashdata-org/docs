---
sidebar_position: 8
---

# Integra√ß√µes

## O que √© integra√ß√£o entre sistemas?

A **integra√ß√£o entre sistemas** √© o processo de conectar diferentes sistemas ou aplica√ß√µes, de modo que eles possam
**compartilhar informa√ß√µes e trabalhar de maneira coordenada**. A integra√ß√£o permite que dados e processos fluam
entre os sistemas, eliminando silos de informa√ß√£o e melhorando a efici√™ncia operacional, e possui os seguintes objetivo:

* **Automatiza√ß√£o de processos:** reduzir tarefas manuais e repetitivas, permitindo que sistemas troquem informa√ß√µes automaticamente;
* **Centraliza√ß√£o de informa√ß√µes:** unificar dados provenientes de diferentes fontes, facilitando a an√°lise e a tomada de decis√£o;
* **Melhoria da produtividade:** evitar retrabalho e aumentar a velocidade dos processos operacionais;
* **Aperfei√ßoamento da experi√™ncia do usu√°rio:** fornecer uma vis√£o integrada e consistente de dados em diferentes plataformas.

## Como funciona a integra√ß√£o entre sistemas do Hashdata?
A integra√ß√£o entre sistemas permite transferir todas as coletas diretamente dos servidores do **HashData** para um
servidor local (*on-premises*), um servidor na nuvem ou at√© mesmo servidores de terceiros.

H√° duas op√ß√µes de integra√ß√£o, via **API REST** ou com **Hashdata Advanced Reports**.

### 1. Integra√ß√£o via API REST
Uma API REST (*Application Programming Interface Representational State Transfer*) √© uma interface de comunica√ß√£o
entre sistemas que segue os princ√≠pios do REST (*Representational State Transfer*), um estilo de arquitetura para
projetar servi√ßos de rede.

A integra√ß√£o via API REST permite que outros sistemas acessem os dados armazenados no Hashdata. A comunica√ß√£o entre os
sistemas √© feita via requisi√ß√µes HTTPS, utilizando um ***token* de autentica√ß√£o** para garantir a seguran√ßa das informa√ß√µes.

Um token de autentica√ß√£o √© uma sequ√™ncia alfanum√©rica √∫nica, utilizada para autenticar e autorizar um usu√°rio ou
aplica√ß√£o que est√° acessando uma API REST. Ele funciona como uma "chave digital" que comprova que quem est√° realizando
a requisi√ß√£o tem permiss√£o para faz√™-lo.

Ap√≥s habilitar a integra√ß√£o API REST √© necess√°rio selecionar os formul√°rios acess√≠veis por meio desta integra√ß√£o.

O acesso aos dados √© feito por meio dos *end-point*. As URI's de cada recurso √© apresentadas a seguir:

#### **FORMUL√ÅRIOS**
Para listar os formul√°rios habilitados para integra√ß√£o, utilize o seguinte *end-point*:

* https://api2.hashdata.app/v1/export/forms?token={TOKEN}

Considerando que o √∫nico formul√°rio configurado para a integra√ß√£o √© o "Formul√°rio de Dados Pessoais", ao executar a
requisi√ß√£o para o *end-point* de formul√°rios, obt√©m-se uma resposta como ao do exemplo a seguir:

```json
[
  {
    "form_id":"66f172c1dbb522a3729ab9a1",
    "form_name":"Formul√°rio de Dados Pessoais",
    "form_status":"DRAFT"
  }
]
```

#### **USU√ÅRIOS**
Para listar todos os usu√°rios de uma determinada √°rea de trabalho, utiliza o seguinte *end-point*:

* https://api2.hashdata.app/v1/export/users?token={TOKEN}

Por padr√£o, esse *end-point* retorna os dados no formato JSON.
Ao executar a requisi√ß√£o informando apenas o *token* de autentica√ß√£o, obt√©m-se uma resposta como a do exemplo a seguir:

```json
[
  {
      "user_id":"66ae9f205c7ed7e95d183804",
      "user_nickname":"Pedro",
      "user_full_name":"Pedro Alc√¢ntara",
      "user_department":""
  },
  {
      "user_id":"6752ff2b2536410b2897de91",
      "user_nickname":"Jos√©",
      "user_full_name":"Jos√© da Silva",
      "user_department":""
  }
]
```

√â poss√≠vel receber os dados dos usu√°rios no formato CSV (*Comma-Separated Values*). Para isso, basta informar mais dois
par√¢metros: `format` e `separator`. Por exemplo:

```text
https://api2.hashdata.app/v1/export/users?token={TOKEN}&format=csv&separator=;
```
Obtendo-se o seguinte resultado:

```text
user_id;user_nickname;user_full_name;user_department
66ae9f205c7ed7e95d183804;Pedro;Pedro Alc√¢ntara;
6752ff2b2536410b2897de91;Jos√©;Jos√© da Silva;
```

#### **RESPOSTAS**
Para obter as respostas de um determinado formul√°rio, √© necess√°rio informar, al√©m do *token* de autentica√ß√£o, o `formID`
(identifica√ß√£o do formul√°rio):

* https://api2.hashdata.app/v1/export/forms/{formId}/responses?token={TOKEN}

O *end-point* possui tamb√©m os seguintes par√¢metros opcionais:

* `removeNewLineFromTexts`: *boolean* - remove quebras de linhas das respostas do tipo texto (√© recomendado configurar com 'true');
* `instantStart`: *DateTime* - Data/hora inicial usada para filtrar as respostas;
* `instantEnd`: *DateTime* - Data/hora final usada para filtrar as respostas.

Use os par√¢metros `instantStart` e `instantEnd` para paginar a resposta ou para obter os dados progressivamente (conforme inseridos no sistema).

:::success Formatos aceitos
Os par√¢metros `instantStart` e `instantEnd` aceitam qualquer formato de `Date` do Javascript, por exemplo, data no
formato string (ISO 8601): `2024-12-31T23:59:59.999Z` (hora UTC).

Para evitar problemas com fuso hor√°rio, no caso do Hor√°rio Oficial Brasileiro (UTC-3), pode-se obter a data por meio de
**par√¢metros num√©ricos** (YYYY, MM, DD, HH, MM, SS, MS):
```javascript
const numericDate = new Date(2024, 11, 31, 23, 59, 59, 999);
console.log(numericDate); // Exemplo: 2024-12-31T23:59:59.999Z
```
A URI para acessar as respostas do "Formul√°rio de Dados Pessoais", a partir das 23:59:59 do dia 31/12/2024 seria:

https://api2.hashdata.app/v1/export/forms/66f172c1dbb522a3729ab9a1/responses?token={TOKEN}&instantStart=2024-12-31T20:59:59.999Z
:::

````mdx-code-block
<details>
    <summary>**üîí Envio do Token de Autentica√ß√£o em uma API REST: URI vs. Cabe√ßalho**</summary>
    <article>
        Em uma API REST, o **token de autentica√ß√£o** pode ser enviado de duas formas para validar e autorizar
o acesso a recursos protegidos:

        1. **Envio pela URI (*Query Parameter*)**
        2. **Envio pelo Cabe√ßalho HTTP (HD-API-TOKEN)**

        Cada m√©todo tem vantagens e desvantagens, especialmente quando se trata de **seguran√ßa da informa√ß√£o**.

        ---

        <h3> **1. Envio do Token pela URI** </h3>
        Exemplo de requisi√ß√£o com o token na **query string** da URL:
        ```
        GET /users/export?token=abc123
        ```
        <h4> **Vantagens** </h4>
        - ‚úÖ **Facilidade de implementa√ß√£o**: √© simples incluir o token como um par√¢metro na URL, sem necessidade de modificar cabe√ßalhos da requisi√ß√£o.
        - ‚úÖ **Uso em links diretos**: pode ser √∫til quando o cliente precisa compartilhar um link autenticado para um recurso espec√≠fico.

        <h4> **Desvantagens** </h4>
        - ‚ùå **Exposi√ß√£o em logs e hist√≥ricos**: como a URL fica vis√≠vel no navegador, hist√≥rico do usu√°rio e logs do servidor, o token pode ser facilmente comprometido.
        - ‚ùå **Facilidade de intercepta√ß√£o**: se a requisi√ß√£o n√£o estiver protegida por **HTTPS**, um atacante pode capturar o token ao monitorar o tr√°fego de rede.
        - ‚ùå **Risco de cache**: algumas configura√ß√µes de proxy e servidores podem armazenar a URL com o token, permitindo acesso indevido posteriormente.

        ---

        <h3> **2. Envio do Token pelo Cabe√ßalho HTTP (HD-API-TOKEN)** </h3>
        Exemplo de requisi√ß√£o enviando o token no **cabe√ßalho HTTP**:
        ```
        GET /users/export
        HD-API-TOKEN: abc123
        ```
        <h4> **Vantagens** </h4>
        - ‚úÖ **Maior seguran√ßa**: o token n√£o √© exposto na URL, reduzindo o risco de vazamento em logs, hist√≥ricos de navega√ß√£o ou caches.
        - ‚úÖ **Melhor controle de acesso**: cabe√ßalhos HTTP s√£o mais f√°ceis de manipular para pol√≠ticas de seguran√ßa, como restri√ß√µes de CORS e prote√ß√£o contra ataques de **replay**.
        - ‚úÖ **Compat√≠vel com autentica√ß√£o JWT e OAuth**: esse m√©todo √© amplamente utilizado para autentica√ß√£o baseada em tokens, como **JWT (JSON Web Token)** e **OAuth 2.0**.

        <h4> **Desvantagens** </h4>
        - ‚ùå **Maior complexidade na implementa√ß√£o**: requer que o cliente configure corretamente o cabe√ßalho da requisi√ß√£o, o que pode ser mais dif√≠cil em algumas aplica√ß√µes.
        - ‚ùå **Incompatibilidade com alguns servi√ßos**: certos navegadores ou clientes HTTP podem ter restri√ß√µes para modificar cabe√ßalhos personalizados.
    </article>
</details>
````

### 2. Integra√ß√£o com Hashdata Advanced Reports
A integra√ß√£o com o [**Hashdata Advanced Reports**](/advanced-reports) permite a cria√ß√£o relat√≥rios e pain√©is avan√ßados atualizados em tempo real,
ou seja, os dados inseridos nos formul√°rios s√£o automaticamente exportados para os relat√≥rios e pain√©is. Tanto os
pain√©is quanto os relat√≥rios s√£o f√°ceis de criar e n√£o requerem conhecimento especializado.

<h4></h4> 3. Formul√°rios exportados
Ap√≥s definir quais integra√ß√µes ser√£o utilizadas, √© necess√°rio informar quais formul√°rios devem ser integrados ao
Hashdata Advanced Reports e quais devem ser exportados via API REST.

:::warning Aten√ß√£o!
Os rascunhos de formul√°rios tamb√©m podem ser exportados / integrados, mas √© necess√°rio ter em mente que esses formul√°rios
podem ter sua estrutura alterada a qualquer momento.
:::


### 3. Configura√ß√£o da integra√ß√£o dos Formul√°rios


